<!DOCTYPE html>
<head>
    <!--settings and refs-->
    <title>Profile Viewer</title>
    <link rel="stylesheet" href="./darkView.css">
    
    <!--meta-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="alizardguy">
    <meta name="keywords" content="HTML, CSS, JavaScript, TK, profile">
    <meta name="description" content="a simple darkmode viewer for the TK site profile standard.">
    <meta charset="UTF-8">

    <!--card-->
    <meta name="twitter:title" content="Profile Viewer">
    <meta name="twitter:site" content="@rep-tiled.tk">
    <meta name="twitter:creator" content="@alizardguy">
    <meta name="twitter:description" content="Simple dark mode viewer for the profile.json files of sites">
    <meta name="twitter:image" content="https://rep-tiled.tk/profileView/DarkViewer/profileJsonLogo.png">

    <!--JQuery-->
    <script src="../jQuery.js"></script>

</head>
<body>
    <!--header-->
    <header>
    <article>
            <div class="topHead">
            <span id="topLine"><h1>Profile Dark View</h1></span>
            </div>
        </article>
    </header>

    <!--script include-->
    <script src="./scripts/darkGetJson.js"></script>

    

    <!--body-->
    <div class="mainBody">

        <div class="row">
            <!--left-->
                <div class="column left">
                    <br>
                </div>       
            
            <!--middle-->
                
                <div class="column middle">
                    
                    <!--search bar-->
                    <div class="searchHolder">
                    <input class="searchInput" type="text" placeholder="name.tk" id="search" autocomplete="url">
                    </div>

                    <br>

                    <article>
                    <div class="middleInfo">

                    <a id="userPhotoLink" href="">
                        <img src="https://i.imgur.com/ZVA8eHl.png" alt="profilePhoto" width="300" height="300" id="pfp">
                    </a>

                    <h3 class="profileSubText" id="site"></h1>

                    <span display: inline style="display: flex; align-items: center; justify-content: center;">
                    <h1 id="name"></h1>
                    <h2 id="pronouns" class="profileSubText"></h2>
                    </span>
                    
                    <p id="userBio" visible ="false" style="text-align: center; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;"></p>
                    
                    
                
                    <details>
                    <summary id="Contacts" class="profileNoSelect" hidden="true">Friends</summary>
                        <h2 id="people">No friends :(</h1>
                      
                    </details>

                <div id="Neos" hidden="true">
                    <details>
                    <summary class="profileNoSelect">Neos VR</summary>
                        <h2 id="neosName">NO NEOS ACCOUNT FOUND</h1>
                        <h2 id="neosUserID"></h1>
                    </details>
                </div>

                <div id="CommonSocailMedias" hidden="true">
                    <details>
                    <summary class="profileNoSelect">Socail Medias</summary>
                        
                    <h2><a class="cleanHyper" id="twitterLink" href="" hidden="true">Twitter</a></h2>

                    <h2><a class="cleanHyper" id="githubLink" href="" hidden="true">Github</a></h2>
                    </details>
                </div>

                </div> 
                </article>
            </div> 
            
            <!--right-->
                <div class="column right">
                    <br>
                </div>
              
            </div>  



    </div>
    
    <script>
        loadParms();
        function loadParms(){
        const queryString = window.location.search;
        const urlParams = new URLSearchParams(queryString);
        const parmSite = urlParams.get('site')

        if(urlParams.has('site')){
            console.log(urlParams)
            console.log(parmSite);

            finalSearch = parmSite;
            if(finalSearch.includes("/profile.json")){}else{finalSearch = finalSearch + "/profile.json"} //this is so gross, please don't do this
            if(finalSearch.includes("https://")){}else{finalSearch = "https://" + finalSearch}
            
            getData(finalSearch.replace('"', "").replace('"', ""));
        }
    }
    </script>

    <!--search script-->
    <script>

        var searchedName;
        var finalSearch;
        /*search url*/
        var input = document.getElementById("search");
        input.addEventListener("keyup", function(event) {
        // enter
        if (event.key === 'Enter') {
        // Cancel the default action, if needed
        event.preventDefault();
        // Trigger

        finalSearch = document.getElementById("search").value;
        if(finalSearch.includes("/profile.json")){}else{finalSearch = finalSearch + "/profile.json"} //this is so gross, please don't do this
        if(finalSearch.includes("https://")){}else{finalSearch = "https://" + finalSearch}

        finalSearch = '"'+finalSearch + '"'
        const url = new URL(window.location);
        url.searchParams.set('site', finalSearch);
        window.history.pushState({}, '', url);

        loadParms();
        
        }
        });

        window.onpopstate = function(event) {
            loadParms();
        }
    </script>

    <footer>
        <div class="footer">
        <a class="NoBlue" href="../about.html">what is this?</a>
        </div>
    </footer>
</body>